
---

# &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;灯具进销存系统
# &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;软件体系结构描述
# &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;V1.0 正式版

## &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;CuteGroup 
## &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;2017-10-22
---
### 目录
1、引言  
	1.1、编织目的  
	1.2、词汇表  
	1.3、参考资料  
2、产品描述  
3、逻辑视角  
4、组合视角  
	4.1、开发包图  
	4.2、运行时进程  
	4.3、物理部署  
5、接口视角  
	5.1、模块的职责  
	5.2、用户界面层的分解  
		5.2.1、用户界面层模块的职责  
		5.2.2、用户界面层模块的接口规范  
		5.2.3、用户界面层模块的设计原理  
	5.3、业务逻辑层的分解  
		5.3.1、业务逻辑层模块的职责  
		5.3.2、业务逻辑层模块的接口规范  
	5.4、数据层的分解
		5.4.1、数据层层模块的职责  
		5.4.2、数据层层模块的接口规范  
6、信息视角   
	6.1、数据持久化对象  
	6.2、Txt持久化格式  
	6.3、数据库表  


###### 1. 引言

###### &nbsp;&nbsp;&nbsp;&nbsp; 1.1 编制目的
&nbsp;&nbsp;&nbsp;&nbsp;本报告详细完成对灯具进销存系统的概要设计，达到指导详细设计和开发的目的，同时实现和测试人员及用户的沟通。  
&nbsp;&nbsp;&nbsp;&nbsp;本报告面向开发人员，测试人员及最终用户而编写，是了解系统的导航。  

###### &nbsp;&nbsp;&nbsp;&nbsp;1.2词汇表
|词汇名称 |词汇含义| 备注|  
|---|---|---|  
|_ui|表示某展示层||  
|_bl|表示某逻辑层||  
|_data|表示某数据层||  

###### &nbsp;&nbsp;&nbsp;&nbsp;1.3 参考资料
1、灯具进销存系统需求规格说明文档  
2、灯具进销存系统用例文档  


###### 2. 产品概述
&nbsp;&nbsp;&nbsp;&nbsp;参考灯具进销存系统用例文档和灯具进销存系统软件需求规格说明中对产品的概括描述。
###### 3.逻辑视角
&nbsp;&nbsp;&nbsp;&nbsp;灯具进销存系统中，选择了分层体系结构风格，将系统分为3层（展示层、业务逻辑层、数据层）能够很好地示意整个高层抽象。展示层包含GUI页面的实现，业务逻辑层包含业务逻辑处理的实现，数据层负责数据的持久化和访问。分层体系结构的逻辑视角和逻辑设计方案如图1和图2所示。  
   
**图1 参照体系结构风格的包图表达逻辑视角**   

![](https://i.imgur.com/aaC1mGB.png)
  
  
**图2 软件体系结构逻辑设计方案**  

![](https://i.imgur.com/ZpdWAsY.png)


###### 4. 组合视角<br>
###### &nbsp;&nbsp;&nbsp;&nbsp; 4.1 开发包图<br>
&nbsp;&nbsp;&nbsp;&nbsp;灯具进销存系统的最终开发包设计如表1所示。<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表1 灯具进销存系统的最终开发包设计**  
  
|开发（物理）包|依赖的其他开发包|  
|---|---|  
|mainui|VIPui,presentui,listui,saleui,storeui,goodsui,accountui,userui,vo|  
|saleui|saleblserves,界面类库包，vo|  
|saleblservice|  
|salebl|VIPbl,presentbl,listbl,storebl,goodsbl,accountbl,po,saleblserves|  
|saledataservice|JavaRMI ,po|  
|saledata|databaseultility,po,saledataservice|  
|VIPui|VIPblserves,界面类库包，vo|  
|VIPblservice|  
|VIPbl|po,VIPblservice|  
|VIPdataservice|JavaRMI ,po|  
|VIPdata|databaseultility,po,VIPdataservice|  
|presentui|presentblserves,界面类库包，vo|  
|presentblservice|  
|presentbl|po,VIPbl,presentblservice|  
|presentdataservice|JavaRMI ,po|  
|presentdata|databaseultility,po,presentdataservice|  
|listui|listblserves,界面类库包，vo|  
|listblservice|  
|listbl|po,storebl,goodsbl,accountbl,presentbl,listblservice|  
|listdataservice|JavaRMI ,po|  
|listdata|databaseultility,po,listdataservice|  
|storeui|storeblserves,界面类库包，vo|  
|storeblservice|  
|storebl|po,goodsbl,storeblservice|  
|storedataservice|JavaRMI ,po|  
|storedata|databaseultility,po,storedataservice|  
|goodsui|goodsblserves,界面类库包，vo|  
|goodsblservice|  
|goodsbl|po,goodsblservice|  
|goodsdataservice|JavaRMI ,po|  
|goodsdata|databaseultility,po,goodsdataservice|  
|accountui|accountblserves,界面类库包，vo|  
|accountblservice|  
|accountbl|po,accountblservice|  
|accountdataservice|JavaRMI ,po|  
|accountdata|databaseultility,po,accountdataservice|  
|Userui|Userblserves,界面类库包，vo|  
|Userblservice|  
|Userbl|po,Userblservice|  
|Userdataservice|JavaRMI ,po|  
|Userdata|databaseultility,po,Userdataservice|  
|vo|  
|po|  
|utilitybl|  
|界面类库包|  
|JavaRMI|  
|databaseultility|JDBC|  



灯具进销存系统客户端开发包图如图3所示，服务器端开发包图如图4所示。  

**图3 灯具进销存系统客户端开发包图**  
  
![](https://i.imgur.com/cLdt8oK.png)
  
**图4 灯具进销存系统服务器端开发包图**  
  
![](https://i.imgur.com/GabBxGf.png)

###### &nbsp;&nbsp;&nbsp;&nbsp; 4.2 运行时进程
&nbsp;&nbsp;&nbsp;&nbsp;在灯具进销存系统中，会有多个客户端进程和一个服务器端进程，其进程图如图5所示。结合部署图，客户端进程是在客户端机器上运行，服务器端进程在服务器端机器上运行。  
  

**图5 进程图**  
  
![](https://i.imgur.com/Ot3gBrX.png)

###### &nbsp;&nbsp;&nbsp;&nbsp; 4.3 物理部署
&nbsp;&nbsp;&nbsp;&nbsp;灯具进销存系统中客户端构件是放在客户端机器上，服务器端构件是放在服务器端机器上。在客户端节点上，还要部署RMIStub构件。由于Java RMI构件属于JDK6.0的一部分，所以，在系统JDK环境已经设置好的情况下，不需要再独立部署。部署图如图6所示。 
 
**图6 部署图**    
  
![](https://i.imgur.com/I17WkIH.png)

###### 5. 接口视角

###### &nbsp;&nbsp;&nbsp;&nbsp; 5.1 模块的职责
&nbsp;&nbsp;&nbsp;&nbsp;客户端模块和服务器端模块视图分别如图7和图8所示。客户端各层和服务器端各层的职责分别如表2和表3所示。  
  
**图7 客户端模块视图**   
  
![](https://i.imgur.com/c3rh6H2.png)  
  

**图8 服务器端模块视图**  
  
![](https://i.imgur.com/5aLRHSF.png)


&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表2 客户端各层的职责**    

| 层 | 职责 |  
|---|---|  
|启动模块|负责初始化网络通信机制，启动用户界面|  
|展示层|基于窗口的灯具进销存客户端用户界面|  
|业务逻辑层|对于用户界面的输入响应和业务处理逻辑|  
|网络模块|利用Java RMI 机制查找 RMI 服务|  

&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表3 服务器端各层的职责**    

| 层 |职责|  
|---|---|  
|启动模块|负责初始化网络通信机制，启动用户界面  
|数据层|负责数据的持久化及数据访问接口  
|网络模块|利用Java RMI 机制开启 RMI 服务，注册 RMI 服务  

&nbsp;&nbsp;&nbsp;&nbsp;每一层只是使用下方直接接触的层。层和层之间仅仅是通过接口调用来完成的。层与层之间调用的接口如表4所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表4 层之间调用的接口**    

|接口|服务调用方|服务提供方|  
|---|---|---|  
|VIPblService<br/>PresentblService<br/>ListblService<br/>SaleblService<br/>StoreblService<br/>GoodsblService<br/>AccountblService<br/>UserblService|客户端展示层|客户端业务逻辑层  
|VIPDataService<br/>PresentDataService<br/>ListDataService<br/>SaleDataService<br/>StoreDataService<br/>GoodsDataService<br/>AccountDataService<br/>UserDataService|客户端业务逻辑层|服务器端数据层  

###### &nbsp;&nbsp;&nbsp;&nbsp; 5.2 用户界面层的分解
&nbsp;&nbsp;&nbsp;&nbsp;根据需求，系统存在29个用户界面：界面跳转如图10所示。  
  

**图10 用户界面跳转**  
  
![](https://i.imgur.com/LmCUQCU.png)  

服务器端和客户端的用户界面设计接口是一致的，只是具体的页面不一样。用户界面类如图11所示。  
   
**图11 用户界面类**  
  
  
![](https://i.imgur.com/46nojbZ.png)
 

&nbsp;&nbsp;&nbsp;&nbsp; 5.2.1 用户界面层模块的职责  
&nbsp;&nbsp;&nbsp;&nbsp;如表5所示为用户界面层模块的职责。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表5 用户界面层模块的职责**    

|模块|职责|  
|---|---|  
|MainFrame|界面Frame，负责界面的显示和界面的跳转|  

&nbsp;&nbsp;&nbsp;&nbsp; 5.2.2 用户界面层模块的接口规范  
&nbsp;&nbsp;&nbsp;&nbsp; 用户界面层模块的接口规范如表6所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表6 用户界面层模块的接口规范**    

<table>
<tr>
<td rowspan="3">MainFrame</td>
<td>语法</td> <td>init(args:String[])</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td> <td>显示Frame以及LoginPanel</td>
</tr>
</table>

用户界面层需要的服务接口如表7所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表7 用户界面层模块需要的服务接口**    

|服务名|服务|  
|---|---|  
|*blService.*|每个界面对应一个业务逻辑接口，该接口提供界面所需的全部服务|  

&nbsp;&nbsp;&nbsp;&nbsp; 5.2.3 用户界面层模块设计原理  
&nbsp;&nbsp;&nbsp;&nbsp;用户界面利用Java的JavaFX库来实现。  

###### &nbsp;&nbsp;&nbsp;&nbsp; 5.3 业务逻辑层的分解  
&nbsp;&nbsp;&nbsp;&nbsp; 业务逻辑层包括多个针对界面的业务逻辑处理对象。  

&nbsp;&nbsp;&nbsp;&nbsp; 5.3.1 业务逻辑层模块的职责  
&nbsp;&nbsp;&nbsp;&nbsp; 业务逻辑层模块的职责如表8所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表8 业务逻辑层模块的职责**    

|模块|职责|  
|---|---|  
|*bl|每个业务逻辑模块对应一个界面，该模块负责实现它对应的界面所需要的服务|    

&nbsp;&nbsp;&nbsp;&nbsp; 5.3.2 业务逻辑层模块的接口规范  

&nbsp;&nbsp;&nbsp;&nbsp; Account业务逻辑层模块的接口规范如表9所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表9 Account业务逻辑层模块的接口规范**  


### Accountbl模块的接口规范<br/>
<table>
<tr>
<td colspan ="3">**提供的服务（供接口）**</td>
</tr>
<tr>
<td rowspan="3">Accountbl.getGoodsInfo</td>
<td>语法</td> <td>public List<GoodsVO> getGoodsInfo() </td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td> <td>返回上一财政年所有商品信息</td>
</tr>
<tr>
<td rowspan="3">Accountbl.getVIPInfo</td>
<td>语法</td> <td>public List<VIPVO> getVIPInfo() </td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td> <td>返回上一财政年所有客户信息</td>
</tr>
<tr>
<td rowspan="3">Accountbl.saveInitAccountInfo</td>
<td>语法</td> <td>public ResultMessage saveInitAccountInfo(InitAccountVO) </td>
</tr>
<tr>
<td>前置条件</td> <td>已填写好期初建账的必要信息</td>
</tr>
<tr>
<td>后置条件</td> <td>持久化保存期初建账信息，更新客户，账户，商品数据</td>
</tr>
<tr></tr>
<tr>
<td rowspan="3">Accountbl.addAccount</td>
<td>语法</td> <td>public ResultMessage initAndSaveAccount(AccountVO vo);</td>
</tr>
<tr>
<td>前置条件</td> <td>财务人员已填好新账户信息</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存新账户信息</td>
</tr>
<tr>
<td rowspan="3">Accountbl.deleteAccount</td>
<td>语法</td> <td>public ResultMessage deleteAccount(String name);</td>
</tr>
<tr>
<td>前置条件</td> <td>财务人员删除账户</td>
</tr>
<tr>
<td>后置条件</td><td>持久化删除帐户信息</td>
</tr>
<tr>
<td rowspan="3">Accountbl.modifyAccount</td>
<td>语法</td> <td>public ResultMessage modifyAccount(AccountVO vo);</td>
</tr>
<tr>
<td>前置条件</td> <td>财务人员修改账户信息后保存</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存账户信息</td>
</tr>
<tr>
<td rowspan="3">Accountbl.findAccount</td>
<td>语法</td> <td>public List<AccountVO> findAccount();</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有账户的列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.newPaymentList</td>
<td>语法</td> <td>public String newPaymentList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回新付款单的单据编号</td>
</tr>
<tr>
<td rowspan="3">Accountbl.newCollectionList</td>
<td>语法</td> <td>public String newCollectionList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回新收款单的单据编号</td>
</tr>
<tr>
<td rowspan="3">Accountbl.newCashExpenseList</td>
<td>语法</td> <td>public String newCashExpenseList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回新现金费用单的单据编号</td>
</tr>
<tr>
<td rowspan="3">Accountbl.openDraft</td>
<td>语法</td> <td>public List<FinanceListVO> openDraft()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有草稿单列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.openCollectionDraft</td>
<td>语法</td> <td>public List<CollectionListVO> openCollectionDraft()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有收款单的草稿单列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.openPaymentDraft</td>
<td>语法</td> <td>public List<PaymentListVO> openPaymentDraft()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有付款单的草稿单列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.openCashExpenseDraft</td>
<td>语法</td> <td>public List<CashExpenseListVO> openCashExpenseDraft()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有现金费用单的草稿单列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.openCommited</td>
<td>语法</td> <td>public List<FinanceListVO> openComitted()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有提交过的单据列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.openPaymentCommited</td>
<td>语法</td> <td>public List<PaymentListVO> openPaymentComitted()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有提交过的付款单列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.openCollectionCommited</td>
<td>语法</td> <td>public List<CollectionListVO> openCollectionComitted()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有提交过的收款单列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.openCashExpenseCommited</td>
<td>语法</td> <td>public List<CashExpenseListVO> openCashExpenseComitted()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有提交过的现金费用单列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.savePaymentList</td>
<td>语法</td> <td>public ResultMessage savePaymentList(PaymentListVO)</td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个付款回合</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存付款单数据</td>
</tr>
<tr>
<td rowspan="3">Accountbl.saveCollectionList</td>
<td>语法</td> <td>public ResultMessage saveCollectionList(CollectionListVO)</td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个收款回合</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存收款单数据</td>
</tr>
<tr>
<td rowspan="3">Accountbl.saveCashExpenseList</td>
<td>语法</td> <td>public ResultMessage saveCashExpenseList(CashExpenseListVO)</td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个现金费用回合</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存现金费用单数据</td>
</tr>
<tr>
<td rowspan="3">Accountbl.deletePaymentList</td>
<td>语法</td> <td>public ResultMessage deletePaymentList(String id)</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>持久化删除付款单数据</td>
</tr>
<tr>
<td rowspan="3">Accountbl.deleteCollectionList</td>
<td>语法</td> <td>public ResultMessage deleteCollectionList(String id)</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>持久化删除收款单数据</td>
</tr>
<tr>
<td rowspan="3">Accountbl.deleteCashExpenseList</td>
<td>语法</td> <td>public ResultMessage deleteCashExpenseList(String id)</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>持久化删除现金费用单数据</td>
</tr>
<tr>
<td rowspan="3">Accountbl.findVIP</td>
<td>语法</td> <td>public List<VIPVO> findVIP(String info)</td>
</tr>
<tr>
<td>前置条件</td> <td>输入会员关键字进行模糊查找</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有符合条件的会员列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.findAccount</td>
<td>语法</td> <td>public List<accountVO> findAccount()</td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个收款／付款／现金费用回合</td>
</tr>
<tr>
<td>后置条件</td><td>返回银行账户列表</td>
</tr>
<tr>
<td rowspan="3">Accountbl.commitPaymentList</td>
<td>语法</td> <td>public ResultMessage commitPaymentList(PaymentListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>已填写好付款单信息</td>
</tr>
<tr>
<td>后置条件</td><td>提交单据并持久化保存付款单数据</td>
</tr>
<tr>
<td rowspan="3">Accountbl.commitCollectionList</td>
<td>语法</td> <td>public ResultMessage commitCollectionList(CollectionListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>已填写好收款单信息</td>
</tr>
<tr>
<td>后置条件</td><td>提交单据并持久化保存收款单数据</td>
</tr>
<tr>
<td rowspan="3">Accountbl.commitCashExpenseList</td>
<td>语法</td> <td>public ResultMessage commitCashExpenseList(CashExpenseListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>已填写好现金费用单信息</td>
</tr>
<tr>
<td>后置条件</td><td>提交单据并持久化保存现金费用单数据</td>
</tr>
</table>

<table>
<tr>
<td colspan = "2">**需要的服务（需接口）**</td>
</tr>
<tr>
<td>服务名</td> <td>服务</td>
</tr>
<tr>
<td>Goods.getAllGoods()</td> <td>获取所有商品的信息</td>
</tr>
<tr>
<td>VIP.getAllVIP()</td> <td>获取所有客户的信息</td>
</tr>
<tr>
<td>AccountDataService.getBankAccountInfor(String name)</td> <td>获取银行账户信息</td>
</tr>
<tr>
<td>AccountDataService.addBankAccountInfor(AccountPO po)</td> <td>持久化添加银行账户信息</td>
</tr>
<tr>
<td>AccountDataService.saveBankAccountInfor(AccountPO po)</td> <td>持久化保存银行账户信息</td>
</tr>
<tr/>
<td>AccountDataService.getCollectionList(String id)</td> <td>获取收款单</td>
</tr>
<tr>
<td>AccountDataService.getPaymentList(String id)</td> <td>获取付款单</td>
</tr>
<tr>
<td>AccountDataService.getCashExpenseList(String id)</td> <td>获取现金费用单</td>
</tr>
<tr>
<td>AccountDataService.getDraftList()</td> <td>获取所有草稿单列表</td>
</tr>
<tr>
<td>AccountDataService.getCollectionDraftList()</td> <td>获取收款单草稿单列表</td>
</tr>
<tr>
<td>AccountDataService.getPaymentDraftList()</td> <td>获取付款单草稿单列表</td>
</tr>
<tr>
<td>AccountDataService.getCahExpenseDraftList()</td> <td>获取现金费用单草稿单列表</td>
</tr>
<tr>
<td>AccountDataService.InsertCollectionList()</td> <td>持久化添加收款单</td>
</tr>
<tr>
<td>AccountDataService.InsertPaymentList()</td> <td>持久化添加付款单</td>
</tr>
<tr>
<td>AccountDataService.InsertCashExpenseList()</td> <td>持久化添加现金费用单</td>
</tr>
</table>

&nbsp;&nbsp;&nbsp;&nbsp; List业务逻辑层模块的接口规范如表10所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表10 List业务逻辑层模块的接口规范**  

<table>
<tr>
<td colspan ="3">提供的服务（供接口）</td>
</tr>
<tr>
<td rowspan="3">Listbl.checkList</td>
<td>语法</td> <td>public ArrayList<listVO> checkList();</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>系统显示所有表单</td>
</tr>
<tr>
<td rowspan="3">Listbl.checkSaleDetailForm</td>
<td>语法</td> <td>public List<SaleDetailVO> checkSaleDetailForm(SaleDetailConditionVO vo);</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回销售明细记录</td>
</tr>
<tr>
<td rowspan="3">Listbl.checkBusinessProcessForm</td>
<td>语法</td> <td>public Map<ListType,String> checkBusinessProcessForm(BusinessProcessConditionVO vo);</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回经营历程列表</td>
</tr>
<tr>
<td rowspan="3">Listbl.getSpecificList</td>
<td>语法</td> <td>public ListVO getSpecificList(ListType type, String id);</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回具体的某个单据信息</td>
</tr>
<tr>
<td rowspan="3">Listbl.hongchong</td>
<td>语法</td> <td>public void hongchong(ListType type, String id);</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存一个生成一个一模一样但是仅仅把数量取负数的单子并入账</td>
</tr>
<tr>
<td rowspan="3">Listbl.hongchongAndCopy</td>
<td>语法</td> <td>public String hongchongAndCopy(ListType type, String id);</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存一个生成一个一模一样但是仅仅把数量取负数的单子并入账,返回一个新的草稿单的单据编号</td>
</tr>
<tr>
<td rowspan="3">Listbl.checkBusinessCircumForm</td>
<td>语法</td> <td>public BusinessCircumVO checkBusinessCircumForm(Date begainTime, Date EndTime);</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回经营情况表</td>
</tr>
<tr>
<td rowspan="3">Listbl.approvalList</td>
<td>语法</td> <td>public void approvalList(ListType type, String ID, ListVO);</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存单据审批后结果</td>
</tr>
</table>

<table>
<tr>
<td colspan = "2">需要的服务（需接口）</td>
</tr>
<tr>
<td>服务名</td> <td>服务</td>
</tr>
<tr>
<td>Salebl.getStockList(String ID)</td> <td>获取进货单信息</td>
</tr>
<tr>
<td>Salebl.getReturnStockList(String ID)</td> <td>获取进货退货单信息</td>
</tr>
<tr>
<td>Salebl.getSaleList(String ID)</td> <td>获取销售单信息</td>
</tr>
<tr>
<td>Salebl.getReturnSaleList(String ID)</td><td>获取销售退货单信息</td>
</tr>
<tr>
<td>Accountbl.getCollectionList(String ID)</td><td>获取收款单信息</td>
</tr>
<tr>
<td>Accountbl.getPaymentList(String ID)</td><td>获取付款单信息</td>
</tr>
<tr>
<td>Accountbl.getCashList(String ID)</td><td>获取现金费用单信息</td>
</tr>
<tr>
<td>Storebl.getstorePresentList(String ID)</td><td>获取库存赠送单信息</td>
</tr>
<tr>
<td>Storebl.getstoreOverflowList(String ID)</td><td>获取库存报溢单信息</td>
</tr>
<tr>
<td>Storebl.getstoreLostList(String ID)</td><td>获取库存报损单信息</td>
</tr>
</table>

&nbsp;&nbsp;&nbsp;&nbsp; VIP业务逻辑层模块的接口规范如表11所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表11 VIP业务逻辑层模块的接口规范**  


<table>
<tr>
<td colspan ="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;提供的服务（供接口）</td>
</tr>
<tr>
<td rowspan="3">VIP.newVIP</td>
<td>语法</td> <td> public String newVIP(String telephone);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择新建客户</td>
</tr>
<tr>
<td>后置条件</td><td>系统显示客户电话和编号</td>
</tr>
<tr>
<td rowspan="3">VIP.findVIP</td>
<td>语法</td> <td> public List<VIPVO> findVIP(String info,String type);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户输入信息模糊查找客户</td>
</tr>
<tr>
<td>后置条件</td><td>系统显示模糊查找后符合要求的客户列表</td>
</tr>
<tr>
<td rowspan="3">VIP.deleteVIP</td>
<td>语法</td> <td> public ResultMessage deleteVIP(String id);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择删除客户</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新客户列表</td>
</tr>
<tr>
<td rowspan="3">VIP.modifyVIP</td>
<td>语法</td> <td> public ResultMessage modifyVIP(VIPVO vo);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择修改客户信息</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新客户信息</td>
</tr>
<tr>
<td rowspan="3">VIP.initAndSaveVIP</td>
<td>语法</td> <td>public ResultMessage initAndSaveVIP(VIPVO vo);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户保存已初始化的客户信息</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新客户信息</td>
</tr>
<tr>
<td rowspan="3">VIP.getVIPInfo</td>
<td>语法</td> <td>public List<VIPVO> getVIPInfo();</td>
</tr>
<tr>
<td>前置条件</td><td>用户选择查看所有客户信息</td>
</tr>
<tr>
<td>后置条件</td><td>系统显示所有客户信息</td>
</tr>
</table>
<table>
<tr>
<td colspan = "2">需要的服务（需接口）</td>
</tr>
<tr>
<td>服务名</td> <td>服务</td>
</tr>
<tr>
<td>VIPDataService.newVIP(String telephone)</td> <td>新建会员</td>
</tr>
<tr>
<td>VIPDataService.findVIP(String info)</td> <td>模糊查找会员</td>
</tr>
<tr>
<td>VIPDataService.deleteVIP(String id)</td> 
<td>删除会员</td>
</tr>
<tr>
<td>VIPDataService.modifyVIP(VIPVO vo)</td> 
<td>修改会员信息</td>
</tr>
<tr>
<td>VIPDataService.initAndSaveVIP(VIPVO vo)</td> 
<td>初始化并保存客户信息</td>
</tr>
<tr>
<td>VIPDataService.getVIPInfo()</td> 
<td>获取所有客户信息</td>
</tr>
</table>

&nbsp;&nbsp;&nbsp;&nbsp; Present业务逻辑层模块的接口规范如表12所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表12 Present业务逻辑层模块的接口规范**  

<table>
<tr>
<td colspan ="3">提供的服务（供接口）</td>
</tr>
<tr>
<td rowspan="3">Presentbl.allStrategy</td>
<td>语法</td> <td>public List<PresentVO> allStrategy()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有赠送策略的列表 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.allPresentForMembership</td>
<td>语法</td> <td>public List<PresentForMembershipVO> allPresentForMembership()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有针对用户级别型赠送策略的列表</td>
</tr>
<tr>
<td rowspan="3">Presentbl.allPresentForSpecialPackage</td>
<td>语法</td> <td>public List<PresentForSpeciaPackageVO> allPresentForSpecialPackage()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有特价包型赠送策略的列表</td>
</tr>
<tr>
<td rowspan="3">Presentbl.allPresentForSum</td>
<td>语法</td> <td>public List<PresentForSumVO> allPresentForSum()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有针对总价型赠送策略的列表</td>
</tr>
<tr>
<td rowspan="3">Presentbl.getStrategy</td>
<td>语法</td> <td>public List<PresentVO> getStrategy(SaleVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>已经输入了必要的销售信息 </td>
</tr>
<tr>
<td>后置条件</td><td>返回对应的赠送策略列表 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.addPresentForMembership</td>
<td>语法</td> <td>public ResultMessage addPresentForMembership(PresentForMembershipVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>已填好针对用户级别型赠送策略必要的信息，且输入都合法 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存针对用户级别型赠送策略信息 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.addPresentForSpecialPackage</td>
<td>语法</td> <td>public ResultMessage addPresentForSpecialPackage(PresentForSpecialPackageVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>已填好特价包型赠送策略必要的信息，且输入都合法 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存特价包型赠送策略信息 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.addPresentForSum</td>
<td>语法</td> <td>public ResultMessage addPresentForSum(PresentForSumVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>已填好针对总价型赠送策略必要的信息，且输入都合法 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存针对总价型赠送策略信息 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.deletePresentForMembership</td>
<td>语法</td> <td>public ResultMessage deletePresentForMembership(String id)</td>
</tr>
<tr>
<td>前置条件</td> <td>无 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化删除该针对用户级别型赠送策略信息，并返回是否删除成功 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.deletePresentForSpecialPackage</td>
<td>语法</td> <td>public ResultMessage deletePresentForSpecialPackage(String id)</td>
</tr>
<tr>
<td>前置条件</td> <td>无 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化删除该特价包型赠送策略信息，并返回是否删除成功 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.deletePresentForSum</td>
<td>语法</td> <td>public ResultMessage deletePresentForSum(String id)</td>
</tr>
<tr>
<td>前置条件</td> <td>无 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化删除针对总价型赠送策略信息,并返回是否删除成功 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.savePresentForMembership</td>
<td>语法</td> <td>public ResultMessage savePresentForMembership(PresentForMembershipVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td> 要保存的策略信息都合法 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存该针对用户级别型赠送策略信息，并返回是否保存成功 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.savePresentForSpecialPackage</td>
<td>语法</td> <td>public ResultMessage savePresentForSpecialPackage(PresentForSpecialPackageVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td> 要保存的策略信息都合法 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存该特价包型赠送策略信息，并返回是否保存成功 </td>
</tr>
<tr>
<td rowspan="3">Presentbl.savePresentForSum</td>
<td>语法</td> <td>public ResultMessage savePresentForSum(PresentForSumVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>要保存的策略信息都合法 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存该针对总价型赠送策略信息,并返回是否保存成功 </td>
</tr>
</table>
  
<table>
<tr>
<td colspan = "2">需要的服务（需接口）</td>
</tr>
<tr>
<td>服务名</td> <td>服务</td>
</tr>
<tr>
<td>DatabaseFactory.getPresentDatabase</td><td>得到Present数据库的服务的引用</td>
</tr>
<tr>
<td>PresentDataService.insert(PresentForMembershipPO po)</td><td>插入一个针对用户级别型赠送策略持久化对象</td>
</tr>
<tr>
<td>PresentDataService.insert(PresentForSpecialPackagePO po)</td><td>插入一个特价包型赠送策略持久化对象</td>
</tr>
<tr>
<td>PresentDataService.insert(PresentForSumPO po)</td><td>插入一个针对总价型赠送策略持久化对象</td>
</tr>
<tr>
<td>PresentDataService.deletePresentForMembership(String id)</td><td>删除一个针对用户级别型赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.deletePresentForSpecialPackage(String id)</td><td>删除一个特价包型赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.deletePresentForSum(String id)</td><td>删除一个针对总价型赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.update(PresentForMembershipPO po)</td><td>更新一个针对用户级别型赠送策略持久化对象</td>
</tr>
<tr>
<td>PresentDataService.update(PresentForSpecialPackagePO po)</td><td>更新一个特价包型赠送策略持久化对象</td>
</tr>
<tr>
<td>PresentDataService.update(PresentForSumPO po)</td><td>更新一个针对总价型赠送策略持久化对象</td>
</tr>
<tr>
<td>PresentDataService.getPresentForMembership()</td><td>得到所有针对用户级别型赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.getPresentForSpecialPackage()</td><td>得到所有特价包型赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.getPresentForSum()</td><td>得到所有针对总价型赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.getPresentForMembership(VIPGrade grade)</td><td>得到所有针对特定用户级别赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.getPresentForSpecialPackage(List<String> GoodsID)</td><td>得到所有含有商品列表中商品的特价包型赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.getPresentForSum(int sum)</td><td>得到所有针对该总价型赠送策略持久化对象 </td>
</tr>
<tr>
<td>PresentDataService.get()</td><td>得到所有赠送策略持久化对象</td>
</tr>
</table>

&nbsp;&nbsp;&nbsp;&nbsp; Sale业务逻辑层模块的接口规范如表13所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表13 Sale业务逻辑层模块的接口规范**  

<table>
<tr>
<td colspan ="3">提供的服务（供接口）</td>
</tr>
<tr>
<td rowspan="3">Sale.createSaleList</td>
<td>语法</td> <td>public String createSaleList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>如果能成功创建，返回销售单单据编号，如果不能成功创建，返回错误信息 </td>
</tr>
<tr>
<td rowspan="3">Sale.createSaleReturnList</td>
<td>语法</td> <td>public String createSaleReturnList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>如果能成功创建，返回销售退货单单据编号，如果不能成功创建，返回错误信息 </td>
</tr>
<tr>
<td rowspan="3">Sale.createStockList</td>
<td>语法</td> <td>public String createStockList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>如果能成功创建，返回进货单单据编号，如果不能成功创建，返回错误信息 </td>
</tr>
<tr>
<td rowspan="3">Sale.createStockReturnList</td>
<td>语法</td> <td>public String createStockReturnList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>如果能成功创建，返回进货退货单单据编号，如果不能成功创建，返回错误信息 </td>
</tr>
<tr>
<td rowspan="3">Sale.openDraftList</td>
<td>语法</td> <td>public List<SalesmanListVO> openDraftList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>打开草稿单列表 </td>
</tr>
<tr>
<td rowspan="3">Sale.openSaleDraftList</td>
<td>语法</td> <td>public List<SaleListVO> openSaleDraftList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>打开销售草稿单列表 </td>
</tr>
<tr>
<td rowspan="3">Sale.openSaleReturnDraftList</td>
<td>语法</td> <td>public List<SaleReturnListVO> openSaleReturnDraftList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>打开销售退货草稿单列表 </td>
</tr>
<tr>
<td rowspan="3">Sale.openStockDraftList</td>
<td>语法</td> <td>public List<StockListVO> openStockDraftList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>打开进货草稿单列表 </td>
</tr>
<tr>
<td rowspan="3">Sale.openStockReturnDraftList</td>
<td>语法</td> <td>public List<StockReturnListVO> openStockReturnDraftList()</td>
</tr>
<tr>
<td>前置条件</td> <td>无</td>
</tr>
<tr>
<td>后置条件</td><td>打开进货退货草稿单列表 </td>
</tr>
<tr>
<td rowspan="3">Sale.saveSaleDraftList</td>
<td>语法</td> <td>public ResultMessage saveSaleDraftList(SaleListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个销售回合</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存销售草稿单数据 </td>
</tr>
<tr>
<td rowspan="3">Sale.saveSaleReturnDraftList</td>
<td>语法</td> <td>public ResultMessage saveSaleReturnDraftList(SaleReturnListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个销售退货回合</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存销售退货草稿单数据 </td>
</tr>
<tr>
<td rowspan="3">Sale.saveStockDraftList</td>
<td>语法</td> <td>public ResultMessage saveStockDraftList(StockListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个进货回合</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存进货草稿单数据 </td>
</tr>
<tr>
<td rowspan="3">Sale.saveStockReturnDraftList</td>
<td>语法</td> <td>public ResultMessage saveStockReturnDraftList(StockReturnListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个进货退货回合</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存进货退货草稿单数据 </td>
</tr>
<tr>
<td rowspan="3">Sale.commitSaleList</td>
<td>语法</td> <td>public ResultMessage commitSaleList(SaleListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>销售单信息填写完整且合法</td>
</tr>
<tr>
<td>后置条件</td><td>提交销售单并持久化保存销售单数据</td>
</tr>
<tr>
<td rowspan="3">Sale.commitSaleReturnList</td>
<td>语法</td> <td>public ResultMessage commitSaleReturnList(SaleReturnListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>销售退货单信息填写完整且合法</td>
</tr>
<tr>
<td>后置条件</td><td>提交销售退货单并持久化保存销售退货单数据</td>
</tr>
<tr>
<td rowspan="3">Sale.commitStockList</td>
<td>语法</td> <td>public ResultMessage commitStockList(StockListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>进货单信息填写完整且合法</td>
</tr>
<tr>
<td>后置条件</td><td>提交进货单并持久化保存进货单数据</td>
</tr>
<tr>
<td rowspan="3">Sale.commitStockReturnList</td>
<td>语法</td> <td>public ResultMessage commitStockReturnList(StockReturnListVO vo)</td>
</tr>
<tr>
<td>前置条件</td> <td>进货退货单信息填写完整且合法</td>
</tr>
<tr>
<td>后置条件</td><td>提交进货退货单并持久化保存进货退货单数据</td>
</tr>
<tr>
<td rowspan="3">Sale.findVIP</td>
<td>语法</td> <td>public List<VIPVO> findVIP(String info, SalesmanListType type) </td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个销售/进货/进货退货/销售退货回合</td>
</tr>
<tr>
<td>后置条件</td><td>返回所有符合单据类型和输入条件的会员的列表</td>
</tr>
<tr>
<td rowspan="3">Sale.findGoods</td>
<td>语法</td> <td>public List<GoodsVO> findGoods(String info) </td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个销售/进货/进货退货/销售退货回合</td>
</tr>
<tr>
<td>后置条件</td><td>查询所有符合条件的商品的列表</td>
</tr>
<tr>
<td rowspan="3">Sale.findPresent</td>
<td>语法</td> <td>public PresentResultVO findPresent(SaleVO vo) </td>
</tr>
<tr>
<td>前置条件</td> <td>启动一个销售回合</td>
</tr>
<tr>
<td>后置条件</td><td>返回查询赠送策略后的结果</td>
</tr>
</table>

<table>
<tr>
<td colspan = "2">需要的服务（需接口）</td>
</tr>
<tr>
<td>服务名</td> <td>服务</td>
</tr>
<tr>
<td>DatabaseFactory.getSalesDatabase</td><td>得到Sales数据库的服务的引用</td>
</tr>
<tr>
<td>SalesDataService.insert(SaleListPO po)</td><td>在数据库中插入销售单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.insert(SaleReturnListPO po)</td><td>在数据库中插入销售退货单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.insert(StockListPO po)</td><td>在数据库中插入进货单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.insert(StockReturnListPO po)</td><td>在数据库中插入进货退货单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.deleteSaleList(String id)</td><td>在数据库中删除销售单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.deleteSaleReturnList(String id)</td><td>在数据库中删除销售退货单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.deleteStockList(String id)</td><td>在数据库中删除进货单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.deleteStockReturnList(String id)</td><td>在数据库中删除进货退货单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.update(SaleListPO po)</td><td>在数据库中更新销售单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.update(SaleReturnListPO po)</td><td>在数据库中更新销售退货单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.update(StockListPO po)</td><td>在数据库中更新销售单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.update(StockReturnListPO po)</td><td>在数据库中更新销售单的单一持久化对象</td>
</tr>
<tr>
<td>SalesDataService.getSaleList(State state)</td><td>得到所有该状态的销售单持久化对象</td>
</tr>
<tr>
<td>SalesDataService.getSaleReturnList(State state)</td><td>得到所有该状态的销售退货单持久化对象</td>
</tr>
<tr>
<td>SalesDataService.getStockList(State state)</td><td>得到所有该状态的进货单持久化对象</td>
</tr>
<tr>
<td>SalesDataService.getStockReturnList(State state)</td><td>得到所有该状态的进货退货单持久化对象</td>
</tr>
<tr>
<td>SalesDataService.get(State state)</td><td>得到所有该状态的持久化对象</td>
</tr>
</table>

&nbsp;&nbsp;&nbsp;&nbsp; User业务逻辑层模块的接口规范如表14所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表14 User业务逻辑层模块的接口规范**  

<table>
<tr>
<td colspan ="3">提供的服务（供接口）</td>
</tr>
<tr>
<td rowspan = "3">User.login</td>
<td>语法</td><td>public ResultMessage login(String name,String password)</td>
</tr>
<tr>
<td>前置条件</td><td>Password符合输入规则</td>
</tr>
<tr>
<td>后置条件</td><td>查找是否存在相应的User,根据输入的password返回登录验证的结果</td>
</tr>
<tr>
<td rowspan = "3">User.logout</td>
<td>语法</td><td> public ResultMessage logout();</td>
</tr>
<tr>
<td>前置条件</td><td>已登陆</td>
</tr>
<tr>
<td>后置条件</td><td>登出</td>
</tr>
<tr>
<td rowspan = "3">User.getCurrentUserInfo</td>
<td>语法</td><td> public UserVO getCurrentUserInfo();</td>
</tr>
<tr>
<td>前置条件</td><td>已登陆</td>
</tr>
<tr>
<td>后置条件</td><td>返回当前用户的信息</td>
</tr>
<tr>
<td rowspan = "3">User.changePassword</td>
<td>语法</td><td>public ResultMessage changePassword(String old,String new)</td>
</tr>
<tr>
<td>前置条件</td><td>无</td>
</tr>
<tr>
<td>后置条件</td><td>若旧密码输入正确，则更新为新密码</td>
</tr>
<tr>
<td rowspan = "3">User.sendMessage</td>			//层内接口
<td>语法</td><td> public ResultMessage sendMessage(MessageVO vo, UserRole role)</td>
</tr>
<tr>
<td>前置条件</td><td>无</td>
</tr>
<tr>
<td>后置条件</td><td>给指定角色的用户发送消息</td>
</tr>
<tr>
<td rowspan = "3">User.checkMessage</td>
<td>语法</td><td> public List<MessageVO> checkMessage()</td>
</tr>
<tr>
<td>前置条件</td><td>用户已登录</td>
</tr>
<tr>
<td>后置条件</td><td>返回该用户的所有消息</td>
</tr>
<tr>
<td rowspan = "3">User.new</td>
<td>语法</td><td>public String newUser(String name)</td>
</tr>
<tr>
<td>前置条件</td><td>已输入新用户名称</td>
</tr>
<tr>
<td>后置条件</td><td>查找是否存在相同的User,若不存在，则返回新用户编号</td>
</tr>
<tr>
<td rowspan = "3">User.initAndSave</td>
<td>语法</td><td>public ResultMessage initAndSave(UserVO)</td>
</tr>
<tr>
<td>前置条件</td><td>password,level符合输入规则</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存新用户信息</td>
</tr>
<tr>
<td rowspan = "3">User.findUser</td>
<td>语法</td><td>public List<UserVO> findUser(String info)</td>
</tr>
<tr>
<td>前置条件</td><td>无</td>
</tr>
<tr>
<td>后置条件</td><td>返回符合条件的用户列表</td>
</tr>
<tr>
<td rowspan = "3">User.modify</td>
<td>语法</td><td>public ResultMessage modify(UserVO)</td>
</tr>
<tr>
<td>前置条件</td><td>password,level符合输入规则</td>
</tr>
<tr>
<td>后置条件</td><td>持久化更新User的信息</td>
</tr>
<tr>
<td rowspan = "3">User.delete</td>
<td>语法</td><td>public ResultMessage delete(String id)</td>
</tr>
<tr>
<td>前置条件</td><td>无</td>
</tr>
<tr>
<td>后置条件</td><td>持久化删除User</td>
</tr>
<tr>
<td rowspan = "3">User.viewLog</td>
<td>语法</td><td>public List<OperationVO> viewLog()</td>
</tr>
<tr>
<td>前置条件</td><td> 经理或财务人员已登陆 </td>
</tr>
<tr>
<td>后置条件</td><td>返回日志信息</td>
</tr>
<tr>
<td rowspan = "3">User.saveOpertion</td>		//层内接口
<td>语法</td><td> public ResultMessage saveOperation(OperationVO)</td>
</tr>
<tr>
<td>前置条件</td><td>完成一个完整操作</td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存操作记录</td>
</tr>
</table>

<table>
<tr>
<td colspan = "2">需要的服务（需接口）</td>
</tr>
<tr>
<td>服务名</td> <td>服务</td>
</tr>
<tr>
<td>DatabaseFactory.getUserDatabase</td><td>得到User数据库的服务的引用</td>
</tr>
<tr>
<td>DatabaseFactory.getMessageDatabase</td><td>得到Message数据库的服务的引用</td>
</tr>
<tr>
<td>DatabaseFactory.getOperationLogDatabase</td><td>得到OperationLog数据库的服务的引用</td>
</tr>
<tr>
<td>UserDataService.insert(UserPO po)</td><td>在数据库中插入单一持久化对象</td>
</tr>
<tr>
<td>UserDataService.delete(UserPO po)</td><td>在数据库中删除单一持久化对象</td>
</tr>
<tr>
<td>UserDataService.update(UserPO po)</td><td>在数据库中更新单一持久化对象</td>
</tr>
<tr>
<td>UserDataService.find(String id)</td><td>根据ID在数据库中查找单一持久化对象</td>
</tr>
<tr>
<td>MessageDataService.insert(MessagePO po)</td><td>在数据库中插入单一持久化对象</td>
</tr>
<tr>
<td>MessageDataService.delete(MessagePO po)</td><td>在数据库中删除单一持久化对象</td>
</tr>
<tr>
<td>MessageDataService.find(String id)</td><td>根据用户ID在数据库中查找该用户的消息</td>
</tr>
<tr>
<td>OperationLogDataService.insert(OperationPO po)</td><td>在数据库中插入单一持久化对象</td>
</tr>
<tr>
<td>OperationLogDataService.delete(OperationPO po)</td><td>在数据库中删除单一持久化对象</td>
</tr>
<tr>
<td>OperationLogDataService.findAll()</td><td>得到所有持久化对象</td>
</tr>

&nbsp;&nbsp;&nbsp;&nbsp; Goods业务逻辑层模块的接口规范如表15所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表15 Goods业务逻辑层模块的接口规范**  
<table>
<tr>
<td colspan ="3">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;提供的服务（供接口）</td>
</tr>
<tr>
<td rowspan="3">Goods.newGoods</td>
<td>语法</td> <td> public String newGoods(String name,String category);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择新建商品</td>
</tr>
<tr>
<td>后置条件</td><td>系统显示商品名称和编号</td>
</tr>
<tr>
<td rowspan="3">Goods.findGoods</td>
<td>语法</td> <td> public List<GoodsVO> findGoods(String info,String type);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户输入信息模糊查找商品</td>
</tr>
<tr>
<td>后置条件</td><td>系统显示模糊查找后符合要求的商品列表</td>
</tr>
<tr>
<td rowspan="3">Goods.deleteGoods</td>
<td>语法</td> <td> public ResultMessage deleteGoods(String id);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择删除商品</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新商品列表</td>
</tr>
<tr>
<td rowspan="3">Goods.modifyGoods</td>
<td>语法</td> <td> public ResultMessage modifyGoods(GoodsVO vo);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择修改商品信息</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新商品信息</td>
</tr>
<tr>
<td rowspan="3">Goods.initAndSaveGoods</td>
<td>语法</td> <td>public ResultMessage initAndSaveGoods(GoodsVO vo);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户保存已初始化的商品信息</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新商品信息</td>
</tr>
<tr>
<td rowspan="3">Goods.newGoodsCategory</td>
<td>语法</td> <td>public ResultMessage newGoodsCategory(String category,String node);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择新建商品分类</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新商品分类信息</td>
</tr>
<tr>
<td rowspan="3">Goods.deleteGoodsCategory</td>
<td>语法</td> <td>public ResultMessage deleteGoodsCategory(String category);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择删除商品分类</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新商品分类信息</td>
</tr>
<tr>
<td rowspan="3">Goods.modifyGoodsCategory</td>
<td>语法</td> <td>public ResultMessage modifyGoodsCategory(String category);</td>
</tr>
<tr>
<td>前置条件</td> <td>用户选择修改商品分类名称</td>
</tr>
<tr>
<td>后置条件</td><td>系统更新商品分类信息</td>
</tr>
<tr>
<td rowspan="3">Goods.getAllGoodsAndCategory</td>
<td>语法</td> <td>public TreeVO getAllGoodsAndCategory();</td>
</tr>
<tr>
<td>前置条件</td><td>用户选择查看所有分类和所有商品</td>
</tr>
<tr>
<td>后置条件</td><td>系统显示所有分类和所有商品</td>
</tr>
</table>

<table>
<tr>
<td colspan = "2">需要的服务（需接口）</td>
</tr>
<tr>
<td>服务名</td> <td>服务</td>
</tr>
<tr>
<td>GoodsDataService.newGoods(String name,String category)</td> <td>新建商品</td>
</tr>
<tr>
<td>GoodsDataService.findGoods(String info,String type)</td> <td>模糊查找商品</td>
</tr>
<tr>
<td>GoodsDataService.deleteGoods(String id)</td> 
<td>删除商品</td>
</tr>
<tr>
<td>GoodsDataService.modifyGoods(GoodsVO vo)</td> 
<td>修改商品信息</td>
</tr>
<tr>
<td>GoodsDataService.initAndSaveGoods(GoodsVO vo)</td> 
<td>初始化并保存商品信息</td>
</tr>
<tr>
<td>GoodsDataService.newGoodsCategory(String category,String node)</td> 
<td>新建商品分类</td>
</tr>
<tr>
<td>GoodsDataService.deleteGoodsCategory(String category)</td> 
<td>删除商品分类</td>
</tr>
<tr>
<td>GoodsDataService.modifyGoodsCategory(String category)</td> 
<td>修改商品分类名</td>
</tr>
<tr>
<td>GoodsDataService.getAllGoodsAndCategory()</td> 
<td>获取所有商品分类和商品</td>
</tr>
</table>

&nbsp;&nbsp;&nbsp;&nbsp; Store业务逻辑层模块的接口规范如表16所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表16 Store业务逻辑层模块的接口规范**  

<table>
<tr>
<td colspan ="3">提供的服务（供接口）</td>
</tr>
<tr>
<td rowspan = "3">Store.createList</td>
<td>语法</td><td>public ListInitVO createList(ListType type)</td>
</tr>
<tr>
<td>前置条件</td><td> 无 </td>
</tr>
<tr>
<td>后置条件</td><td>返回单据编号和操作员信息</td>
</tr>
<tr>
<td rowspan = "3">Store.openDraftList</td>
<td>语法</td><td>public Map<ListType, String> openDraftList()</td>
</tr>
<tr>
<td>前置条件</td><td> 无 </td>
</tr>
<tr>
<td>后置条件</td><td>打开草稿单列表</td>
</tr>
<tr>
<td rowspan = "3">Store.openList</td>
<td>语法</td><td>public StoreListVO openList(ListType t, String id)</td>
</tr>
<tr>
<td>前置条件</td><td> 无 </td>
</tr>
<tr>
<td>后置条件</td><td>打开一张草稿单</td>
</tr>
<tr>
<td rowspan = "3">Store.saveList</td>
<td>语法</td><td>public void saveList(ListType type, StoreListVO vo)</td>
</tr>
<tr>
<td>前置条件</td><td> 启动一个库存赠送／报溢／报损回合 </td>
</tr>
<tr>
<td>后置条件</td><td>持久化保存单据数据</td>
</tr>
<tr>
<td rowspan = "3">Store.commitList</td>
<td>语法</td><td>public void commitList(ListType type, StoreListVO vo)</td>
</tr>
<tr>
<td>前置条件</td><td>填写完单据信息</td>
</tr>
<tr>
<td>后置条件</td><td>提交单据并持久化保存单据数据</td>
</tr>
<tr>
<td rowspan = "3">Store.searchGoods</td>
<td>语法</td><td>public Map<String,String> findGoods(String id, String name)</td>
</tr>
<tr>
<td>前置条件</td><td>启动一个库存赠送／报溢／报损回合</td>
</tr>
<tr>
<td>后置条件</td><td>查询所有符合条件的商品的列表|</td>
</tr>
<tr>
<td rowspan = "3">Store.getGoods</td>
<td>语法</td><td>public GoodsVO getGoods(String id)</td>
</tr>
<tr>
<td>前置条件</td><td>启动一个库存赠送回合</td>
</tr>
<tr>
<td>后置条件</td><td>返回要查询的商品信息|</td>
</tr>
<tr>
<td rowspan = "3">Store.getStoreNumber</td>
<td>语法</td><td>public int getStoreNumber(String id)</td>
</tr>
<tr>
<td>前置条件</td><td>启动一个库存报溢／报损回合</td>
</tr>
<tr>
<td>后置条件</td><td>返回商品库存数量</td>
</tr>
<tr>
<td rowspan = "3">Store.getOverflowNumber</td>
<td>语法</td><td>public int getOverflowNumber(int numberInReality)</td>
</tr>
<tr>
<td>前置条件</td><td>已添加商品库存数量</td>
</tr>
<tr>
<td>后置条件</td><td>返回报溢数量</td>
</tr>
<tr>
<td rowspan = "3">Store.getLossNumber</td>
<td>语法</td><td>public int getLossNumber(int numberInReality)</td>
</tr>
<tr>
<td>前置条件</td><td>已添加商品库存数量</td>
</tr>
<tr>
<td>后置条件</td><td>返回报损数量</td>
</tr>
<tr>
<td rowspan = "3">Store.check</td>
<td>语法</td><td>public Set<StoreVO> check()</td>
</tr>
<tr>
<td>前置条件</td><td>启动一个库存盘点回合</td>
</tr>
<tr>
<td>后置条件</td><td>返回当天的库存快照</td>
</tr>
<tr>
<td rowspan = "3">Store.view</td>
<td>语法</td><td>public StoreViewVO view(StoreViewStandardVO vo, Date begin, Date end)</td>
</tr>
<tr>
<td>前置条件</td><td>启动一个库存查看回合</td>
</tr>
<tr>
<td>后置条件</td><td>显示所要求的库存信息</td>
</tr>
<tr>
<td rowspan = "3">Store.setAlert</td>
<td>语法</td><td>public void setAlert(Map<String, int>)</td>
</tr>
<tr>
<td>前置条件</td><td>启动一个设置警戒数量回合</td>
</tr>
<tr>
<td>后置条件</td><td>设置商品警戒数量|</td>
</tr>
</table>

<table>
<tr>
<td colspan = "2">需要的服务（需接口）</td>
</tr>
<tr>
<td>服务名</td> <td>服务</td>
</tr>
<tr>
<td>DatabaseFactory.getStoreDatabase</td><td>得到Store数据库的服务的引用</td>
</tr>
<tr>
<td>StoreDataService.insert(StorePO po)</td><td>在数据库中插入单一持久化对象</td>
</tr>
<tr>
<td>StoreDataService.delete(StorePO po)</td><td>在数据库中删除单一持久化对象</td>
</tr>
<tr>
<td>StoreDataService.update(StorePO po)</td><td>在数据库中更新单一持久化对象</td>
</tr>
<tr>
<td>StoreDataService.find(String id)</td><td>根据ID在数据库中查找单一持久化对象</td>
</tr>
<tr>
<td>StoreDataService.finds(String field,int value)</td><td>根据字段名和值进行查找多个持久化对象</td>
</tr>
</table>

###### &nbsp;&nbsp;&nbsp;&nbsp; 5.4 数据层的分解  
&nbsp;&nbsp;&nbsp;&nbsp;数据层主要给业务逻辑层提供数据访问服务，包括对持久化数据的增删改查。  

&nbsp;&nbsp;&nbsp;&nbsp; 5.4.1 数据层模块的职责  
&nbsp;&nbsp;&nbsp;&nbsp; 数据层模块的职责如表17所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表17 数据层模块的职责**    

|模块|职责|  
|---|---|  
|*DataService|持久化数据库的接口，提供集体载入，集体保存，增删改查的服务|  

&nbsp;&nbsp;&nbsp;&nbsp; 5.4.2 数据层模块的接口规范  
&nbsp;&nbsp;&nbsp;&nbsp; 数据层模块的接口规范如表18所示。  
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;**表18 数据层模块的接口规范**    

|模块|职责|  
|---|---|  
|*DataService.*|每个数据层模块的供接口与其业务逻辑层的需接口相对应|  

###### 6. 信息视角
###### &nbsp;&nbsp;&nbsp;&nbsp; 6.1 数据持久化对象
VIP包：  
- VIPPO:编号、分类、级别、姓名、电话、地址、邮编、电子邮箱、应收额度、应收、应付、默认业务员  
Present包：
- Present1PO:策略编号，会员级别，总额，赠品列表（包括赠品编号，名称，数量），折让价格，赠送代金劵金额,开始时间，结束时间  
- Present2PO:策略编号，商品列表（包括每个商品的编号，名称，数量），降价金额，开始时间，结束时间  
- Present3PO:策略编号，总额，赠品列表（包括赠品编号，名称，数量），赠送代金劵金额，开始时间，结束时间  
Sale包：  
- SaleListPO: 单据编号，单据状态，客户，业务员，操作员，仓库，出货商品清单，折让前总额，折让，使用代金卷金额，折让后总额，备注。  
- SaleListItemPO: 商品编号，名称，型号，单价，数量，金额，备注。  
- SaleBackListPO: 单据编号，单据状态，客户，业务员，操作员，仓库，退货商品清单，折让前总额，折让，使用代金卷金额，折让后总额，备注。  
- SaleBackListItemPO: 商品编号，名称，型号，单价，数量，金额，备注。  
- StockListPO: 单据编号，单据状态，客户，业务员，操作员，仓库，进货商品清单，总额，备注。  
- StockListItemPO: 商品编号，名称，型号，单价，数量，金额，备注。  
- StockReturnListPO: 单据编号，单据状态，客户，业务员，操作员，仓库，退货商品清单，总额，备注。  
- StockReturnListItemPO: 商品编号，名称，型号，单价，数量，金额，备注。  
Goods包：  
- GoodsPO类包含商品编号、名称、型号、分类、进价、零售价、最近进价、最近零售价。  
- GoodsCategoryPO类包含商品分类编号，名称，父节点编号，子节点列表，分类下商品列表。  
Store包：  
- StorePO类包含商品编号、名称、型号、库存数量、库存均价、批次、批号、出厂日期、警戒数量。  
- StorePresentListPO类包含单据编号、操作员、审批状态、赠送商品列表。  
- StorePresentListItemPO类包含列表项编号、商品名称、商品赠送数量。  
- StoreOverflowListPO类包含单据编号、操作员、审批状态、报溢商品列表。  
- StoreLostListPO类包含单据编号、操作员、审批状态、报损商品列表。  
- StoreOverflowListItemPO类包含列表项编号、商品名称、实际库存数量、系统中数量、报溢数量，备注。  
- StoreLostListItemPO类包含列表项编号、商品名称、实际库存数量、系统中数量、报损数量，备注。  
Account包：  
- AccountPO:账户名称，余额   
- PaymentListPO: 单据编号，客户，操作员，转账列表，总额汇总。  
- PaymentListItemPO:银行账户，转账金额，备注。  
- CollectionListPO:单据编号，客户，操作员，转账列表，总额汇总。  
- CollectionListItemPO:银行账户，转账金额，备注。  
- CashExpenseListPO:单据编号，操作员，银行账户，条目清单，总额汇总。  
- CashExpenseListItemPO:条目名，金额，备注。  
List包：  
- ListPO:各种单据的编号列表  
User包：  
- UserPO：编号，名称，密码，角色，是否有最高权限  
- MessagePO：题目，内容，时间，收件人  
- OperationPO：操作编号，操作时间，操作员，操作类型，操作内容。  


&nbsp;&nbsp;&nbsp;&nbsp;持久化用户对象UserPO的定义如下所示。其他PO见原型代码。    

``` java
public class UserPO implements Serializable{
	String id;
	String name;
	String password;
	UserRole role;
	boolean hashighLimit;
	  
	public UserPO(long i,String n,String p,UserRole r){
	id=i;
	name =n;
	password=p;
	role=r;
	}

	public String getName(){
	return name;
	}
	    
	public long getID(){
	      return id;
	}
	  
	public String getPassword(){
	   return password;
	}

	public UserRole getRole(){
	   return role;
	}

}
```

###### &nbsp;&nbsp;&nbsp;&nbsp; 6.2 txt持久化格式
&nbsp;&nbsp;&nbsp;&nbsp; 暂无  
###### &nbsp;&nbsp;&nbsp;&nbsp; 6.3 数据库表  
&nbsp;&nbsp;&nbsp;&nbsp;每个持久化对象对应数据库中的一个表  




